<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Attacking Wifi Series, Part 1<br /> Overview & Commands - Jesse P Lesperance </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="keywords" content="Attacking Wifi Series, Part 1<br /> Overview & Commands, Jesse P Lesperance, Attacking Wifi, Hacking, Pen Testing, Wireless, Aircrack-ng,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Jesse P Lesperance" property="og:site_name" /> <meta content="Attacking Wifi Series, Part 1<br /> Overview & Commands" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Jesse P Lesperance a highly skilled leader in the Information Security space/community." property="og:description" /> <meta content="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands/" property="og:url" /> <meta content="2019-12-03T00:00:00-08:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="Attacking Wifi" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Attacking Wifi Series, Part 1<br /> Overview & Commands" /> <meta name="twitter:url" content="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands/" /> <meta name="twitter:description" content="Jesse P Lesperance a highly skilled leader in the Information Security space/community." /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget --> <script> (function(d, h, m) { var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)) { return; } js = d.createElement(h); js.id = m; js.onload = function() { window.makerWidgetComInit({ position: "left", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" }); }; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "dhm"); </script> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Jesse P Lesperance</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Attacking Wifi Series, Part 1<br /> Overview & Commands</h1> <h4 class="post-meta"></h4> <p class="post-summary"> Posted by : on <time datetime="2019-12-03 00:00:00 -0800" itemprop="datePublished" >Dec 3, 2019</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Attacking Wifi" >Attacking Wifi</a > &nbsp; <a href="/blog/categories/Hacking" >Hacking</a > &nbsp; <a href="/blog/categories/Pen Testing" >Pen Testing</a > &nbsp; <a href="/blog/categories/Wireless" >Wireless</a > &nbsp; <a href="/blog/categories/Aircrack-ng" >Aircrack-ng</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000" alt="" /> <br /> <br /> <p>Welcome to the Attacking Wifi Series. This series of blog posts will cover different scenarios around pen testing and Hacking Wifi.</p> <p>This post will highlight many of the different aircrack-ng commands used in hacking/pen testing wireless networks. This post does not go into the how, but is more of a reference of the commands and parameters.</p> <h2 id="table-of-contents">Table of Contents</h2> <ul> <li><a href="#posts-in-this-series">Posts in this series</a></li> <li><a href="#general">General</a> <ul> <li><a href="#monitor-mode">Monitor Mode</a></li> <li><a href="#scanning-networks">Scanning Networks</a></li> <li><a href="#deauthentication-attack">Deauthentication Attack</a></li> </ul> </li> <li><a href="#cracking">Cracking</a> <ul> <li><a href="#iv-based-crack">IV-based Crack</a></li> <li><a href="#ptw-based-crack">PTW Crack</a></li> <li><a href="#word-list-based-crack">Word List Crack</a></li> <li><a href="#airolib-db-crack">Airolib DB Crack</a></li> <li><a href="#jtr-based-crack">JTR-based Crack</a></li> </ul> </li> <li><a href="#wep-attacks">WEP Attacks</a> <ul> <li><a href="#fake-authentication">Fake Authentication</a></li> <li><a href="#arp-request-replay-attack">ARP Request Replay Attack</a></li> <li><a href="#interactive-packet-replay-attack">Interactive Packet Replay Attack</a></li> <li><a href="#korek-chopchop-attack">KoreK ChopChop Attack</a></li> <li><a href="#fragmentation-attack">Fragmentation Attack</a></li> <li><a href="#craft-arp-request-packet">Craft ARP Request Packet</a></li> <li><a href="#inject-packet">Inject Packet</a></li> <li><a href="#fake-shared-key-authentication">Fake Shared Key Authentication</a></li> </ul> </li> <li><a href="#wpa-attacks">WPA Attacks</a> <ul> <li><a href="#cowpatty-attack">coWPAtty Attack</a></li> <li><a href="#pyrit-sniff">Pyrit Sniff</a></li> <li><a href="&amp;pyrit-crack-dictionary">Pyrit Dictionary Crack</a></li> <li><a href="#pyrit-crack-database">Pyrit Database Crack</a></li> </ul> </li> </ul> <h2 id="posts-in-this-series">Posts in this Series</h2> <p>Since this series will be covering several Wifi hacking scenarios, we have decided to make each scenario its own post. Each post will walk you through the steps of the attack. While the steps provided are sufficient for carrying out the attacks, it is recommended that you attain an understanding of the attacks and why they work. Information is provided to allow you to setup each scenario in your own wifi lab so that you can actually practice the attack. If you don’t have a spare AP to use for this, check out <a href="https://lesperance.io/setting-up-wifi-ap-rpi">Rasperry Pi as an Wifi AP</a> on how to create a wifi ap on a raspberry pi for the purpose of practicing hacking wifi.</p> <p>Below is a list of posts for this series.</p> <ul> <li><em>Overview &amp; Commands</em> &lt;– This post</li> <li><a href="https://lesperance.io/hacking-wep-connected-clients">Hacking WEP with Connected Clients</a> - Published on 3/18/20</li> <li><a href="https://lesperance.io/hacking-wep-via-client">Hacking WEP via a Client</a> - Published on 4/23/20</li> <li><a href="https://lesperance.io/hacking-clientless-wep">Hacking Clientless WEP Networks</a> - Published on 4/25/20</li> <li><a href="https://lesperance.io/bypassing-wep-share-key-authentication">Bypassing WEP Shared Key Authentication</a> - Published on 4/27/20</li> <li><a href="https://lesperance.io/hacking-wpa-wpa2-psk">Hacking WPA/WPA2 PSK</a> - Published on 5/4/20</li> </ul> <h2 id="general">General</h2> <h3 id="monitor-mode">Monitor Mode</h3> <p>There are a couple different options for putting your wifi adapter into monitor mode.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">iw dev &lt;interface&gt; set monitor none</code></p> </blockquote> <blockquote> <p><code class="language-plaintext highlighter-rouge">airmon-ng start &lt;interface&gt;</code></p> </blockquote> <h3 id="scanning-networks">Scanning Networks</h3> <p>Airodump-ng is used to scan for wifi networks and clients that are in the range of your wireless card</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">airodump-ng -c &lt;channel&gt; -w &lt;capture&gt; --wps --band abg --essid &lt;essid&gt; --bssid &lt;bssid&gt; &lt;int&gt;</code></p> </blockquote> <p>The required parameters</p> <ul> <li><code class="language-plaintext highlighter-rouge">&lt;int&gt;</code> The wireless interface that is in monitor mode</li> </ul> <p>The following flags are all optional</p> <ul> <li><code class="language-plaintext highlighter-rouge">-c &lt;channel&gt;</code> This will filter your scan to a specific wifi channel</li> <li><code class="language-plaintext highlighter-rouge">--wps</code> This flag will include WPS information for wireless networks found</li> <li><code class="language-plaintext highlighter-rouge">-w &lt;capture&gt;</code> This flag will write the scan results to a file</li> <li><code class="language-plaintext highlighter-rouge">--band &lt;bands&gt;</code> This flag allows you to only scan wifi networks operating on specified bands</li> <li><code class="language-plaintext highlighter-rouge">--essid &lt;essid&gt;</code> This flag will filter the scan to a specific Client</li> <li><code class="language-plaintext highlighter-rouge">--bssid &lt;bssid&gt;</code> This flag will filter the scan to a specific AP</li> </ul> <h3 id="deauthentication-attack">Deauthentication Attack</h3> <p>This attacks sends disassociate packets to one or more clients connected to a specific AP</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -0 &lt;num&gt; -a &lt;ap&gt; -c &lt;client&gt; &lt;int&gt;</code></p> </blockquote> <p>All parameters and flags are required</p> <ul> <li><code class="language-plaintext highlighter-rouge">-0</code> Deauthentication attack method</li> <li><code class="language-plaintext highlighter-rouge">&lt;num&gt;</code> The number of deauths to send, 0 will send continuously</li> <li><code class="language-plaintext highlighter-rouge">-a &lt;ap&gt;</code> The mac address of the AP</li> <li><code class="language-plaintext highlighter-rouge">-c &lt;client&gt;</code> The mac address of the client to deauthenticate</li> <li><code class="language-plaintext highlighter-rouge">&lt;int&gt;</code> The wireless interface to use</li> </ul> <h2 id="cracking">Cracking</h2> <p>The following are various methods that can be used to crack the authentication of wireless networks.</p> <h3 id="iv-based-crack">IV-based Crack</h3> <p>The following is a method of IV-based cracking. This is aircrack-ng’s default methed of cracking when no flags are provided. This method only works for WEP, not WPA/WPA2/WPA3.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aircrack-ng &lt;capture&gt;</code></p> </blockquote> <h3 id="ptw-based-crack">PTW-based Crack</h3> <p>The PTW attack is both the newest and most powerful WEP attack. It only require 20,000 to 40,000 packets to be successful, though in some cases as many as 70,000 packets could be needed for a successful attack.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aircrack-ng -z &lt;capture&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-z</code> Invokes WEP PTW Attack mode</li> </ul> <h3 id="word-list-based-crack">Word List-based Crack</h3> <p>This method works for both WEP and WPA-PSK cracking.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aircrack-ng -w &lt;wordlist&gt; &lt;capture&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-w &lt;wordlist&gt;</code> The wordlist to use to try and crack WEP/WPA-PSK</li> </ul> <p>If the capture file does not contain the APs SSID, you will have to use the following command to specify the extra information aircrack needs for generating the PMKs</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aircrack-ng -w &lt;wordlist&gt; -e &lt;essid&gt; -b &lt;bssid&gt; &lt;capture&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-e &lt;essid&gt;</code> The SSID of the AP</li> <li><code class="language-plaintext highlighter-rouge">-b &lt;bssid&gt;</code> The mac address of the AP</li> </ul> <h3 id="airolib-db-crack">Airolib DB Crack</h3> <p>Airolib-ng is a tool for managing and storing ESSIDs and password lists, compute their Pairwise Master Keys, and use them to crack WPA and WPA2 passwords.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aircrack-ng -r &lt;dbName&gt; &lt;capture&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;dbName&gt; - The name of the airolib-ng database</code></li> </ul> <h3 id="jtr-based-crack">JTR-based Crack</h3> <p>This method uses John the Ripper and a wordlist while applying word mangling rules to attempt to crack a WPA/WPA2 Password</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">john --wordlist=&lt;wordlist&gt; --rules --stdout | aircrack-ng -e &lt;essid&gt; -w - &lt;capture&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">--wordlist=&lt;wordlist&gt; - The word list to use</code></li> <li><code class="language-plaintext highlighter-rouge">--rules - apply word mangling rules</code></li> </ul> <h2 id="wep-attacks">WEP Attacks</h2> <h3 id="fake-authentication">Fake Authentication</h3> <p>The fake authentication attack allows you to associate to an access point using either of the two types of WEP authentication: the open system and shared key authentication.</p> <p>This attack is useful in scenarios where there are no associated clients and you need to fake an authentication to the AP.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -1 0 -e &lt;essid&gt; -a &lt;ap&gt; -h &lt;you&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-1 - Fake Authentication Attack</code></li> <li><code class="language-plaintext highlighter-rouge">0 - The reassociation timing in seconds</code></li> <li><code class="language-plaintext highlighter-rouge">-e &lt;essid&gt; - The wireless network name (ESSID)</code></li> <li><code class="language-plaintext highlighter-rouge">-a &lt;ap&gt; - The AP MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-h &lt;you&gt; - Your attacking MAC address</code></li> </ul> <h3 id="arp-request-replay-attack">ARP Request Replay Attack</h3> <p>The ARP request replay attack is the most effective way to generate new initialization vectors and of all the attacks Aireplay has to offer, this attack is probably the most reliable.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -3 -b &lt;ap&gt; -h &lt;you&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-3 - ARP Request Replay Attack</code></li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt; - The AP MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-h &lt;you&gt; - Your attacking MAC address</code></li> </ul> <p>For this attack, your wireless card needs to be in monitor mode and you will need either the MAC address of an associated client or your own MAC address after having performed a fake authentication with the AP.</p> <h3 id="interactive-packet-replay-attack">Interactive Packet Replay Attack</h3> <p>The Interactive Packet Replay attack allows you to choose a specific packet for replaying/injecting against the target network.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -2 -b &lt;ap&gt; -d ff:ff:ff:ff:ff:ff -f 1 -m 68 -n 86 &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-2 - Interactive Packet Replay Attack</code></li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt; - The AP MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-d ff:ff:ff:ff:ff:ff - Select packets with a broadcast destination address</code></li> <li><code class="language-plaintext highlighter-rouge">-t 1 - Select packets with the "To Distribution System" flag set</code></li> <li><code class="language-plaintext highlighter-rouge">-m &lt;num&gt; - Minimum packet size</code></li> <li><code class="language-plaintext highlighter-rouge">-n &lt;num&gt; - Maximum packet size</code></li> </ul> <h3 id="korek-chopchop-attack">KoreK chopchop attack</h3> <p>The Korek chopchop attack, when successful, can decrypt a WEP data packet without knowing the WEP key and can even work against dynamic WEP.</p> <p>This attack does not recover the WEP key itself; it merely reveals the plaintext of the packets.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -4 -b &lt;ap&gt; -h &lt;you&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-4 - KoreK ChopChop Attack</code></li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt; - The AP MAC address</code></li> <li>`-h <you> - The source MAC address</you></li> </ul> <h3 id="fragmentaion-attack">Fragmentaion Attack</h3> <p>This attack works by obtaining a small amount of the keying material from the packet and then attempts to send ARP and/or LLC packets with known content to the AP. If the packet is successfully echoed back by the AP, then a larger amount of the keying information can be obtained from the returned packet. This process is repeated until 1500 bytes of the PRGA are obtained.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -5 -b &lt;ap&gt; -h &lt;you&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-5 - The Fragmentation Attack</code></li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt; - The AP MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-h &lt;you&gt; - Source MAC address</code></li> </ul> <h3 id="craft-arp-request-packet">Craft ARP Request Packet**</h3> <p>Packetforge-ng is used to create encrypted packets that can later be used for injection. You can create various types of packets such as UDP and ICMP packets although it is most commonly used to create ARP requests for subsequent injection.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">packetforge-ng -0 -a &lt;ap&gt; -h &lt;you&gt; -l &lt;sourceIP&gt; -k &lt;destIP&gt; -y &lt;xorFile&gt; -w &lt;out&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-0 - Generate an ARP request packet</code></li> <li><code class="language-plaintext highlighter-rouge">-a &lt;ap&gt; - The AP MAC Address</code></li> <li><code class="language-plaintext highlighter-rouge">-h &lt;you&gt; - The source MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-k &lt;distIP&gt; - The destination IP</code></li> <li><code class="language-plaintext highlighter-rouge">-l &lt;sourceIP&gt; - The source IP</code></li> <li><code class="language-plaintext highlighter-rouge">-y &lt;xorFile&gt; - The PRGA filename</code></li> <li><code class="language-plaintext highlighter-rouge">-w - The filename to save the packet to</code></li> </ul> <h3 id="inject-packetinteractive-packet-replay">Inject Packet/Interactive Packet Replay</h3> <p>This attack uses a crafted ARP request packet and injects it to capture enough IVs to subsequently crack the WEP key on the AP</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay-ng -2 -r &lt;packet&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-2 - Interactive Packet Replay Attack</code></li> <li><code class="language-plaintext highlighter-rouge">-r &lt;packet&gt; - Filename of the crafted ARP packet</code></li> </ul> <h3 id="fake-shared-key-authentication">Fake Shared Key Authentication</h3> <p>This attack is used for bypassing WEP Share Key Authentication. It uses a captured keystream file and conducts a fake authentication.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">aireplay -1 -0 -e &lt;essid&gt; -y &lt;captureFile&gt; -a &lt;ap&gt; -h &lt;you&gt; &lt;interface&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-1 - Fake Authentication Attack</code></li> <li><code class="language-plaintext highlighter-rouge">0 - Reassociation timing in seconds</code></li> <li><code class="language-plaintext highlighter-rouge">-e &lt;essid&gt; - The wireless network name(SSID)</code></li> <li><code class="language-plaintext highlighter-rouge">-y &lt;captureFile&gt; - Filename of the captured keystream</code></li> <li><code class="language-plaintext highlighter-rouge">-a &lt;ap&gt; - The AP MAC address</code></li> <li><code class="language-plaintext highlighter-rouge">-h &lt;you&gt; - Source MAC address</code></li> </ul> <h2 id="wpa-attacks">WPA Attacks</h2> <h3 id="cowpatty-attack">coWPAtty Attack</h3> <h4 id="dictionary-mode">Dictionary Mode</h4> <p>coWPAtty is a versatile tool that can recover WPA pre-shared keys, from a captured handshake, using either dictionary or rainbow table attacks.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">cowpatty -r &lt;capture&gt; -f &lt;wordlist&gt; -2 -s &lt;essid&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;capture&gt;</code> - The capture filename</li> <li><code class="language-plaintext highlighter-rouge">-f &lt;wordlist&gt;</code> - The wordlist to use</li> <li><code class="language-plaintext highlighter-rouge">-2</code> - Use non-strict mode as coWPAtty has an issue with airodump-ng captures</li> <li>`-s <essid> - The network ESSID</essid></li> </ul> <h4 id="rainbow-table-mode">Rainbow Table Mode</h4> <p>Generate the hashes for our ESSID along with a dictionary file containing password</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">genpmk -f &lt;wordlist&gt; -d &lt;hashesFilename&gt; -s &lt;essid&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-f &lt;wordlist&gt;</code> - The path to the dictionary file</li> <li><code class="language-plaintext highlighter-rouge">-d &lt;hashesFilename&gt;</code> - The filename to save the computed hashes to</li> <li><code class="language-plaintext highlighter-rouge">-s &lt;essid&gt;</code> - The network ESSID</li> </ul> <p>Run coWPAtty using the generated hashes</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">cowpatty -r &lt;capture&gt; -d &lt;hashesFilename&gt; -2 -s &lt;essid&gt;</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;capture&gt;</code> - The capture filename</li> <li><code class="language-plaintext highlighter-rouge">-d &lt;hashesFilename&gt;</code> - The file name of the computed hashes to use</li> <li><code class="language-plaintext highlighter-rouge">-2</code> - Use non-strict mode as coWPAtty has an issue with airodump-ng captures</li> <li><code class="language-plaintext highlighter-rouge">-s &lt;essid&gt;</code> - The network ESSID</li> </ul> <h3 id="pyrit-sniff">Pyrit Sniff</h3> <p>Pyrit, like airolib-ng and coWPAtty, uses a pre-computed database of WPA pre-shared key tables, though with the distinct advantage of being able to leverage GPUs to accelerate the generation of PMK tables.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -r &lt;interface&gt; -o &lt;capture&gt; stripLive</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;interface&gt;</code> - The wireless interface to use</li> <li><code class="language-plaintext highlighter-rouge">-o &lt;capture&gt;</code> - The file to save the captured data to</li> <li><code class="language-plaintext highlighter-rouge">striplive</code> - Only saves the WPA handshakes</li> </ul> <h3 id="validate-the-4-way-handshake">Validate the 4-way handshake</h3> <p>Pyrit is able to analyze the capture file and determine if the capture contains any valid handshakes</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -r &lt;capture&gt; analyze</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;capture&gt;</code> - The capture file</li> </ul> <h3 id="pyrit-crack-dictionary">Pyrit Crack Dictionary</h3> <p>Launching pyrit using a basic dictionary attack</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -r &lt;capture&gt; -i &lt;wordlist&gt; -b &lt;ap&gt; attack_passthrough</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;capture&gt;</code> - The capture file</li> <li><code class="language-plaintext highlighter-rouge">-i &lt;wordlist&gt;</code> - The wordlist file to use</li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt;</code> - The <em>OPTIONAL</em> BSSID of the target AP</li> <li><code class="language-plaintext highlighter-rouge">attack_passthrough</code> - Attempt to crack the WPA password using the wordlist</li> </ul> <h3 id="pyrit-crack-database">Pyrit Crack Database</h3> <h4 id="import-wordlist-into-database">Import Wordlist into Database</h4> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -i &lt;wordlist&gt; import_passwords</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-i &lt;wordlist&gt;</code>- The wordlist to use</li> <li><code class="language-plaintext highlighter-rouge">import_passwords</code> - Import the passwords into the database</li> </ul> <h4 id="add-the-essid-of-the-access-point">Add the ESSID of the Access Point</h4> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -e &lt;essid&gt; create_essid</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-e &lt;essid&gt;</code> - The network ESSID</li> <li><code class="language-plaintext highlighter-rouge">create_essid</code> - Import the network ESSID</li> </ul> <h4 id="compute-the-pmks">Compute the PMKs</h4> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit batch</code></p> </blockquote> <h4 id="launch-pyrit-in-database-mode">Launch Pyrit in database mode</h4> <blockquote> <p><code class="language-plaintext highlighter-rouge">pyrit -r &lt;capture&gt; -b &lt;ap&gt; attack_db</code></p> </blockquote> <ul> <li><code class="language-plaintext highlighter-rouge">-r &lt;capture&gt;</code> - The capture file</li> <li><code class="language-plaintext highlighter-rouge">-b &lt;ap&gt;</code> - The AP’s MAC address</li> </ul> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/2019/12/03/attacking-wifi-commands"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Jesse P Lesperance</div> <div class="card-body"> <p class="author_bio"></p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Attacking Wifi"></div> <li class="tag-head"> <a href="/blog/categories/Attacking Wifi">Attacking Wifi</a> </li> <a name="Attacking Wifi"></a> <div id="#Hacking"></div> <li class="tag-head"> <a href="/blog/categories/Hacking">Hacking</a> </li> <a name="Hacking"></a> <div id="#Pen Testing"></div> <li class="tag-head"> <a href="/blog/categories/Pen Testing">Pen Testing</a> </li> <a name="Pen Testing"></a> <div id="#Wireless"></div> <li class="tag-head"> <a href="/blog/categories/Wireless">Wireless</a> </li> <a name="Wireless"></a> <div id="#Aircrack-ng"></div> <li class="tag-head"> <a href="/blog/categories/Aircrack-ng">Aircrack-ng</a> </li> <a name="Aircrack-ng"></a> <div id="#WEP"></div> <li class="tag-head"> <a href="/blog/categories/WEP">WEP</a> </li> <a name="WEP"></a> <div id="#Raspberry Pi"></div> <li class="tag-head"> <a href="/blog/categories/Raspberry Pi">Raspberry Pi</a> </li> <a name="Raspberry Pi"></a> <div id="#HostAPd"></div> <li class="tag-head"> <a href="/blog/categories/HostAPd">HostAPd</a> </li> <a name="HostAPd"></a> <div id="#WPA"></div> <li class="tag-head"> <a href="/blog/categories/WPA">WPA</a> </li> <a name="WPA"></a> <div id="#WPA2"></div> <li class="tag-head"> <a href="/blog/categories/WPA2">WPA2</a> </li> <a name="WPA2"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000/contact">Contact</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>. Hosted with <a href="https://pages.github.com">Github Pages</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
