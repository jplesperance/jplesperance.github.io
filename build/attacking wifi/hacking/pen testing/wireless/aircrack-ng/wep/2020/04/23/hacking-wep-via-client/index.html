<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Attacking Wifi Series, Part 3<br /> Hacking WEP via a Client - Jesse P Lesperance </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="keywords" content="Attacking Wifi Series, Part 3<br /> Hacking WEP via a Client, Jesse P Lesperance, Attacking Wifi, Hacking, Pen Testing, Wireless, Aircrack-ng, WEP,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Jesse P Lesperance" property="og:site_name" /> <meta content="Attacking Wifi Series, Part 3<br /> Hacking WEP via a Client" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Jesse P Lesperance a highly skilled leader in the Information Security space/community." property="og:description" /> <meta content="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client/" property="og:url" /> <meta content="2020-04-23T00:00:00-07:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="Attacking Wifi" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Attacking Wifi Series, Part 3<br /> Hacking WEP via a Client" /> <meta name="twitter:url" content="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client/" /> <meta name="twitter:description" content="Jesse P Lesperance a highly skilled leader in the Information Security space/community." /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- Maker widget --> <script> (function(d, h, m) { var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)) { return; } js = d.createElement(h); js.id = m; js.onload = function() { window.makerWidgetComInit({ position: "left", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" }); }; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "dhm"); </script> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="sujaykundu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Jesse P Lesperance</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Attacking Wifi Series, Part 3<br /> Hacking WEP via a Client</h1> <h4 class="post-meta"></h4> <p class="post-summary"> Posted by : on <time datetime="2020-04-23 00:00:00 -0700" itemprop="datePublished" >Apr 23, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Attacking Wifi" >Attacking Wifi</a > &nbsp; <a href="/blog/categories/Hacking" >Hacking</a > &nbsp; <a href="/blog/categories/Pen Testing" >Pen Testing</a > &nbsp; <a href="/blog/categories/Wireless" >Wireless</a > &nbsp; <a href="/blog/categories/Aircrack-ng" >Aircrack-ng</a > &nbsp; <a href="/blog/categories/WEP" >WEP</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000" alt="" /> <br /> <br /> <p>In this post we will discuss how to attack a client to force it to generate new IVs rather than the access point.</p> <h3 id="overview">Overview</h3> <p>While it is true that most of the time, hacking a WEP network is accomplished by attacking the access point by generating a packet, that then would be replayed in an effort to get the access point to generate new packets with new IVs.</p> <p>However, there are some reasons for attacking the client instead of the AP.</p> <ul> <li>Some access points max out at 130,000 unique IVs</li> <li>Some access points enforce client-to-client controls</li> <li>MAC Address whitelisting/restrictions</li> <li>Some newer access points can eliminate weak IVs</li> <li>You are unable to successfully fake auth the access point</li> <li>You are out of range for the access point, but are in range of a client</li> </ul> <p>For this scenario, we will be using the information below to illustrate how to conduct the attack and attain the WEP key. There are several different methods of executing this attack. We are only showing one of those methods here, though, we may cover the other methods in a later post.</p> <p><strong>Target Information</strong></p> <ul> <li><strong>BSSID</strong>: 34:08:04:09:3D:38</li> <li><strong>AP Channel</strong>: 3</li> <li><strong>ESSID</strong>: hitme (Open Authentication)</li> <li><strong>Client</strong>: 00:18:4D:1D:A8:1F</li> <li><strong>mon0</strong>: 00:1F:33:F3:51:13</li> </ul> <h3 id="initial-attack-setup">Initial Attack Setup</h3> <p>The first step in every attack scenario is to place the wireless interface in <a href="https://lesperance.io/attacking-wifi-commands#monitor-mode">monitor mode</a> on the same channel as the access point.</p> <blockquote> <p>root@attacker:~# <strong>airmon-ng start wlan0 3</strong></p> </blockquote> <p>This will set <strong>wlan0</strong> into monitor mode as <strong>mon0</strong> on channel 3</p> <h3 id="recon">Recon</h3> <p>Now, an <a href="https://lesperance.io/attacking-wifi-commands#scanning-networks">Airodump sniffing session</a> needs to be started and write the capture file to the disk for usage by Aircrack-ng for breaking the WEP key</p> <blockquote> <p>root@attacker:~# <strong>airodump-ng -c 3 –bssid 34:08:04:09:3D:38 -w wep1 mon0</strong></p> </blockquote> <p>This will start airodump-ng, listening on Channel 3 and filtering on the BSSID and saving the output to <em>wep1</em></p> <h3 id="authenticate">Authenticate</h3> <p>Now, while is isn’t required for this attack, we will conduct a fake authentication attack against the AP for 2 reasons. First, always a good practice to conduct a fake authetication attack against a WEP AP. Second, having you MAC associated with the access point can make this attack more reliable.</p> <p>We conduct a <a href="https://lesperance.io/attacking-wifi-commands#fake-authentication">fake authentication attack</a> against the AP</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -1 0 -e hitme -a 34:08:04:09:3D:38 -h 00:1F:33:F3:51:13 mon0</strong></p> </blockquote> <p>This allows us to associate with the access point.</p> <h3 id="generating-weak-ivs">Generating Weak IVs</h3> <p>Now we can launch the <a href="https://lesperance.io/attacking-wifi-commands#interactive-packet-replay-attack">Interactive Packet Replay Attack</a>. THis attack allows us to choose a specific packet for replaying/injecting against our target network. To achieve our goal, a packet that will be “naturally” successful in generating new initialization vectors must be selected.</p> <p>In this scenario, we are going to attempt to use the natural packet selection method of attack. We are going to capture packets that are within a desired size range and that have the <em>fromDS</em> flag set.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -2 -b 34:08:04:09:3D:38 -d FF:FF:FF:FF:FF:FF -f 1 -m 68 -n 86 mon0</strong></p> </blockquote> <h3 id="cracking-the-wep-key">Cracking the WEP Key</h3> <p>Once we have captured a substantial number of weak IVs, 250,000 for 64-bit keys and 1.5 million for 128-bit keys, we can now use aircrack-ng to crack the key. For this we have 2 options.</p> <p>We are going to use the <a href="https://lesperance.io/attaking-wifi-commands#ptw-based-crack">PTW Crack</a> method. It should be noted, this method only works with ARP request/reply packets.</p> <blockquote> <p>root@attacker:~# <strong>aircrack-ng -z wep1.pcap</strong></p> </blockquote> <p>This should result in displaying the network’s WEP key.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "http://localhost:4000/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/attacking%20wifi/hacking/pen%20testing/wireless/aircrack-ng/wep/2020/04/23/hacking-wep-via-client"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Jesse P Lesperance</div> <div class="card-body"> <p class="author_bio"></p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Attacking Wifi"></div> <li class="tag-head"> <a href="/blog/categories/Attacking Wifi">Attacking Wifi</a> </li> <a name="Attacking Wifi"></a> <div id="#Hacking"></div> <li class="tag-head"> <a href="/blog/categories/Hacking">Hacking</a> </li> <a name="Hacking"></a> <div id="#Pen Testing"></div> <li class="tag-head"> <a href="/blog/categories/Pen Testing">Pen Testing</a> </li> <a name="Pen Testing"></a> <div id="#Wireless"></div> <li class="tag-head"> <a href="/blog/categories/Wireless">Wireless</a> </li> <a name="Wireless"></a> <div id="#Aircrack-ng"></div> <li class="tag-head"> <a href="/blog/categories/Aircrack-ng">Aircrack-ng</a> </li> <a name="Aircrack-ng"></a> <div id="#WEP"></div> <li class="tag-head"> <a href="/blog/categories/WEP">WEP</a> </li> <a name="WEP"></a> <div id="#Raspberry Pi"></div> <li class="tag-head"> <a href="/blog/categories/Raspberry Pi">Raspberry Pi</a> </li> <a name="Raspberry Pi"></a> <div id="#HostAPd"></div> <li class="tag-head"> <a href="/blog/categories/HostAPd">HostAPd</a> </li> <a name="HostAPd"></a> <div id="#WPA"></div> <li class="tag-head"> <a href="/blog/categories/WPA">WPA</a> </li> <a name="WPA"></a> <div id="#WPA2"></div> <li class="tag-head"> <a href="/blog/categories/WPA2">WPA2</a> </li> <a name="WPA2"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000/contact">Contact</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>. Hosted with <a href="https://pages.github.com">Github Pages</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
