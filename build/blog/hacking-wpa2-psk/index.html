<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Hacking WPA/WPA2 PSK - Jesse P Lesperance </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="We will show you how to use aircrack-ng by itself, with an airolib-ng database and with John the Ripper to crack WPA/WPA2 passwords- Hacking WPA/WPA2 PSK"> <meta name="keywords" content="Hacking WPA/WPA2 PSK, Jesse P Lesperance, attacking wifi series,attacking wifi hacking wpa wpa2 psk cracking"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Jesse P Lesperance" property="og:site_name" /> <meta content="Hacking WPA/WPA2 PSK" property="og:title" /> <meta content="article" property="og:type" /> <meta content="We will show you how to use aircrack-ng by itself, with an airolib-ng database and with John the Ripper to crack WPA/WPA2 passwords" property="og:description" /> <meta content="http://localhost:4000/blog/hacking-wpa2-psk/" property="og:url" /> <meta content="2020-05-04T00:00:00-07:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="http://localhost:4000/assets/img/evil-wifi.png" property="og:image" /> <meta content="attacking wifi series" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Hacking WPA/WPA2 PSK" /> <meta name="twitter:url" content="http://localhost:4000/blog/hacking-wpa2-psk/" /> <meta name="twitter:description" content="We will show you how to use aircrack-ng by itself, with an airolib-ng database and with John the Ripper to crack WPA/WPA2 passwords" /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Jesse P Lesperance</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://github.com/jplesperance" >Github</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Hacking WPA/WPA2 PSK</h1> <h4 class="post-meta">We will show you how to use aircrack-ng by itself, with an airolib-ng database and with John the Ripper to crack WPA/WPA2 passwords</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="http://localhost:4000/blog/authors/jesse">jesse</a></span> </span > on <time datetime="2020-05-04 00:00:00 -0700" itemprop="datePublished" >May 4, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/hacking-wpa2-psk/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/attacking wifi series" >attacking wifi series</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000/assets/img/evil-wifi.png" alt="" /> <br /> <br /> <p>In this post we are are going to move on to cracking WPA/WPA2 Pre-shared keys using aircrack-ng. We will show you how to use aircrack-ng by itself, with an airolib-ng database and with John the Ripper to crack WPA/WPA2 passwords</p> <p>The primary difference between cracking WEP and WPA/WPA2 is that while statistical methods can be used for speeding up the cracking of WEP pre-shared keys, only brute force can be used for WPA/WPA2 PSK.</p> <h3 id="overview">Overview</h3> <p>Although WPA-encrypted networks do not suffer from the same cryptographic vulnerabilities as WEP networks, they can still sometimes be easier to crack due to users picking weak passwords. The impact of having to use the brute force approach is a substantial impact to efficiency. A large dictionary can to hours to days to process due to the computational intensity of brute forcing.</p> <p><strong>Target Information</strong></p> <ul> <li><strong>BSSID</strong>: 34:08:04:09:3D:38</li> <li><strong>AP Channel</strong>: 3</li> <li><strong>ESSID</strong>: hitme (WPA2 PSK)</li> <li><strong>Client</strong>: 00:18:4D:1D:A8:1F</li> <li><strong>mon0</strong>: 00:1F:33:F3:51:13</li> </ul> <h3 id="initial-attack-setup">Initial Attack Setup</h3> <p>The first step in every attack scenario is to place the wireless interface in <a href="https://lesperance.io/attacking-wifi-commands#monitor-mode">monitor mode</a> on the same channel as the access point.</p> <blockquote> <p>root@attacker:~# <strong>airmon-ng start wlan0 3</strong></p> </blockquote> <p>This will set <strong>wlan0</strong> into monitor mode as <strong>mon0</strong> on channel 3</p> <h3 id="recon">Recon</h3> <p>Now, an <a href="https://lesperance.io/attacking-wifi-commands#scanning-networks">Airodump sniffing session</a> needs to be started and write the capture file to the disk for usage by Aircrack-ng for breaking the WEP key</p> <blockquote> <p>root@attacker:~# <strong>airodump-ng -c 3 –bssid 34:08:04:09:3D:38 -w wpa-psk mon0</strong></p> </blockquote> <p>This will start airodump-ng, listening on Channel 3 and filtering on the BSSID and saving the output to <em>wep1</em>. Our goal is to capture the WPA 4-way handshake, which takes place when a wireless client connects and authenticates to the access point.</p> <h3 id="de-authentication-attack">De-authentication Attack</h3> <p>We could passively capture the WPA handshake by allowing airodump-ng to run until a new wireless client connects and authenticates to our target network. However, we could use a deauthentication attack on a connected client to speed up the process, which is what we will do here.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -0 1 -a 34:08:04:09:3D:38 -c 00:18:4D:1D:A8:1F mon0</strong></p> </blockquote> <p>After conducting the attack, you can look in the upper right hand corner of the airodump-ng output and should see the we hopefully captured the complete 4-way handshake. In the event of not successfully capturing in, we can either re-run the deauthentication attack against the same client or we can run the attack against a different client.</p> <h3 id="preperation">Preperation</h3> <h4 id="create-airolib-database-optional">Create Airolib Database (Optional)</h4> <p>Airolib-ng is designed to store and manage ESSID and password lists. It computes their PMKs and use them to crack WPA and WPA2 passwords. Since PMKs are reproducable due to the PMK always being the same for a given ESSID and password combination, we are able to pre-compute the PMKs for different combinations and possibly speed up the cracking of the handshake.</p> <p>To get started, we need to create a file containing the ESSID of our target network.</p> <blockquote> <p>root@attacker:~# <strong>echo hitme &gt; essid.txt</strong></p> </blockquote> <p>This enables us to import the new text file into the database</p> <blockquote> <p>root@attacker:~# **airolib-ng <dbName> --import essid essid.txt**</dbName></p> </blockquote> <p>This will automatically create the database if it does not exist.</p> <p>We can verify this by providing the <code class="language-plaintext highlighter-rouge">--stats</code> operation to airolib-ng</p> <blockquote> <p>root@attacker:~# **airolib-ng <dbName> --stats**</dbName></p> </blockquote> <p>In the output, you should see the ESSID you imported in the ESSID column. Now we need to import the password file.</p> <blockquote> <p>root@attacker:~# **airolib-ng <dbName> --import passwd <wordlist>**</wordlist></dbName></p> </blockquote> <p>You will see output indicating the file is being read, along with how many lines have been imported.</p> <p>With all of the data imported, we now need to have airolib-ng all of the corresponding PMKs.</p> <blockquote> <p>root@attacker:~# **airolib-ng <dbName> --batch**</dbName></p> </blockquote> <p>You will see output indicating how many PMKs were generated, the time taken and the generation rate. This can also be validated with the <code class="language-plaintext highlighter-rouge">--stats</code> operation also. You will see 100.0 in the <code class="language-plaintext highlighter-rouge">Done</code> column, indicating 100% completion.</p> <h4 id="prepare-john-the-ripper">Prepare John the Ripper</h4> <p>Using a wordlist with John the Ripper will not yield any results that aircrack-ng would render. For this reason, we will configure JTR to use word mangling.</p> <blockquote> <p>nano /etc/john/john.conf</p> </blockquote> <p>At the endo of the section <code class="language-plaintext highlighter-rouge">List.Rules.Wordlist</code>, add the following 2 lines</p> <blockquote> <p>$[a-zA-Z0-9]$[a-zA-Z0-9] $[0-9]$[0-9]$[0-9]</p> </blockquote> <p>We have added 2 rules. The first will add to characters on to each word in the wordlist, using only the defined charcter(upper and lowercase letters plus, zero to nine). The second adds 3 characters all 0-9.</p> <h4 id="cowpatty-rainbow-tables">coWPAtty Rainbow Tables</h4> <p>This is the main purpose behind coWPAtty, to make use of pre-compiled hashes for cracking WPA passwords. The pre-computed hashes are generated for each unique ESSID.</p> <p>For this, we will use <code class="language-plaintext highlighter-rouge">genpmk</code>, a tool included with coWPAtty.</p> <blockquote> <p>root@attacker:~# **genpmk -f <wordlist> -d hitme-hashes -s hitme**</wordlist></p> </blockquote> <p>Similar to airolib-ng, genpmk will provide output showing how many passphareses were testing and the total time taken, along with through put.</p> <h3 id="crack-the-wpa-key">Crack the WPA Key</h3> <p>We have the 4-way handshake for the target network. Let’s look at how to crack this with aircrack-ng and airolib-ng.</p> <h4 id="wordlist-based-crack">Wordlist-based Crack</h4> <p>Very similar to how we executed a wordlist based crack for WEP, we shall also do for WPA/WPA2</p> <blockquote> <p>root@attacker:~# **aircrack-ng -w <worldlist> wpa-psk-01.cap</worldlist></p> </blockquote> <p>We can analyze the output for aircrack-ng to see whether we were able to crack the WPA PSK or not.</p> <h4 id="airolib-database-based-crack">Airolib Database-based Crack</h4> <p>Aircrack-ng has airolib-ng support built in natively. we just pass the <code class="language-plaintext highlighter-rouge">-r</code> parameter instead of the <code class="language-plaintext highlighter-rouge">-w</code>.</p> <blockquote> <p>root@attacker:~# **aircrack-ng -r <dbName> wpa-psk-01.cap**</dbName></p> </blockquote> <p>In the output, you will notice a substantial increase in the number of keys tested per second.</p> <h4 id="aircrack-ng-with-jtr">Aircrack-ng with JTR</h4> <p>Now that John is configured to mangle words in the wordlist, we can increase our chances of finding the WPA key.</p> <blockquote> <p>root@attacker:~# **./john –wordlist=<wordlist> --rules --stdout | aircrack-ng -d hitme -w - wpa-psk-01.cap**</wordlist></p> </blockquote> <p>Despite using JTR, you will see the aircrack-ng output on your screen, not JTR’s output.</p> <h4 id="cowpatty-dictionary-mode">coWPAtty Dictionary Mode</h4> <p>Dictionary mode is not the reason most people use coWPAtty, but it is still a good idea to know how to use it.</p> <blockquote> <p>root@attacker:~# **cowpatty -r wpa-psk-01.cap -f <wordlist> -2 -s hitme</wordlist></p> </blockquote> <p>The one thing to note about the command above, is the use of the <code class="language-plaintext highlighter-rouge">-2</code> parameter. This tells coWPAtty to use non-strict mode since coWPAtty has an issue with Airdump-ng captures.</p> <h4 id="cowpatty-rainbow-tables-mode">coWPAtty Rainbow Tables Mode</h4> <p>Now that we have our handshake and pre-computed hashes, we can now crack the WPA password</p> <blockquote> <p>root@attacker:~# <strong>cowpatty -r wpa-psk-01.cap -d hitme-hashes -2 -s hitme</strong></p> </blockquote> <p>coWPAtty’s output will display the PSK if we were successful.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/blog/hacking-wpa2-psk/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Jesse P Lesperance </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="http://localhost:4000/assets/img/authors/jesse.webp" alt="Jesse P Lesperance" /> </div> <div class="col-md-6"> <p class="author_bio"></p> <p>Email : </p> <p>Website : https://lesperance.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/jplesperance" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/jesseplesperance" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/jlesperance" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> <a class="social-link" href="https://telegram.com/jplesperance" target="_blank"><i class="fab fa-telegram fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "http://localhost:4000/blog/hacking-wpa2-psk/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/hacking-wpa-wpa2-psk"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Jesse P Lesperance</div> <div class="card-body"> <p class="author_bio"></p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#attacking wifi series"></div> <li class="tag-head"> <a href="/blog/categories/attacking-wifi-series">attacking wifi series</a> </li> <a name="attacking wifi series"></a> <div id="#wifi security"></div> <li class="tag-head"> <a href="/blog/categories/wifi-security">wifi security</a> </li> <a name="wifi security"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000https://github.com/jplesperance">Github</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> </div><footer> Hosted with <a href="https://pages.github.com">Github Pages</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
