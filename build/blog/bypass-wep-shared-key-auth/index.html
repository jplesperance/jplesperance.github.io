<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Bypassing WEP Shared Key Authentication - Jesse P Lesperance </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="In this post, we will focus on attacking an access point that utilizes shared-key authentication- Bypassing WEP Shared Key Authentication"> <meta name="keywords" content="Bypassing WEP Shared Key Authentication, Jesse P Lesperance, attacking wifi series,access wifi attacking security wep bypass authentication"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Jesse P Lesperance" property="og:site_name" /> <meta content="Bypassing WEP Shared Key Authentication" property="og:title" /> <meta content="article" property="og:type" /> <meta content="In this post, we will focus on attacking an access point that utilizes shared-key authentication" property="og:description" /> <meta content="http://localhost:4000/blog/bypass-wep-shared-key-auth/" property="og:url" /> <meta content="2020-04-27T00:00:00-07:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="http://localhost:4000/assets/img/evil-wifi.png" property="og:image" /> <meta content="attacking wifi series" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Bypassing WEP Shared Key Authentication" /> <meta name="twitter:url" content="http://localhost:4000/blog/bypass-wep-shared-key-auth/" /> <meta name="twitter:description" content="In this post, we will focus on attacking an access point that utilizes shared-key authentication" /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Jesse P Lesperance</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://github.com/jplesperance" >Github</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Bypassing WEP Shared Key Authentication</h1> <h4 class="post-meta">In this post, we will focus on attacking an access point that utilizes shared-key authentication</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="http://localhost:4000/blog/authors/jesse">jesse</a></span> </span > on <time datetime="2020-04-27 00:00:00 -0700" itemprop="datePublished" >Apr 27, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/bypass-wep-shared-key-auth/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/attacking wifi series" >attacking wifi series</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000/assets/img/evil-wifi.png" alt="" /> <br /> <br /> <p>Up to this point, our attacks have been focused on WEP access points that were configured with open authentication.</p> <p>Now, we will focus on a WEP access point using a shared key for authentication.</p> <h3 id="overview">Overview</h3> <p>Unlike open authentication, shared key authentication requires more than just knowledge of the SSID, the same secret key must by known by the client and access point.</p> <p>For this scenario, we will be using the information below to illustrate how to conduct the attack and attain the WEP key.</p> <p><strong>Target Information</strong></p> <ul> <li><strong>BSSID</strong>: 34:08:04:09:3D:38</li> <li><strong>AP Channel</strong>: 3</li> <li><strong>ESSID</strong>: hitme (Shared Key Authentication)</li> <li><strong>Client</strong>: 00:18:4D:1D:A8:1F</li> <li><strong>mon0</strong>: 00:1F:33:F3:51:13</li> </ul> <h3 id="initial-attack-setup">Initial Attack Setup</h3> <p>The first step in every attack scenario is to place the wireless interface in <a href="https://lesperance.io/attacking-wifi-commands#monitor-mode">monitor mode</a> on the same channel as the access point.</p> <blockquote> <p>root@attacker:~# <strong>airmon-ng start wlan0 3</strong></p> </blockquote> <p>This will set <strong>wlan0</strong> into monitor mode as <strong>mon0</strong> on channel 3</p> <h3 id="recon">Recon</h3> <p>Now, an <a href="https://lesperance.io/attacking-wifi-commands#scanning-networks">Airodump sniffing session</a> needs to be started and write the capture file to the disk for usage by Aircrack-ng for breaking the WEP key</p> <blockquote> <p>root@attacker:~# <strong>airodump-ng -c 3 â€“bssid 34:08:04:09:3D:38 -w wep1 mon0</strong></p> </blockquote> <p>This will start airodump-ng, listening on Channel 3 and filtering on the BSSID and saving the output to <em>wep1</em></p> <p>Despite have shared key authentication configured on the access point, the AUTH column in airodump will not display SKA until a wireless client authenticates to the network.</p> <h3 id="authenticate">Authenticate</h3> <p>Since the AUTH column is blank, we conduct a <a href="https://lesperance.io/attacking-wifi-commands#fake-authentication">fake authentication attack</a> in order to be able to communicate with the AP.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -1 0 -e hitme -b 34:08:04:09:3D:38 -h 00:1F:33:F3:51:13 mon0</strong></p> </blockquote> <p>If the output from the fake authentication attack specifies <em>AP rejects open-system authentication</em>, we know that the access point is configured for share key authentication.</p> <p>We need to acquire a PRGA XOR file before we can conduct a successful fake authentication attack on the access point. This file is acquired what a client connects to the network, which in a real world network environment can take a while to capture. You really have 2 options when it comes to this: 1 Be patient and wait for a client to connect, this is you only option if there are no currently connected clients on the network 2 Run a deauthentication attack on one of the connected clients to force the client to reassociate to the network, allowing us to capture the shared key authentication handshake.</p> <p>After successfully completing the capture of the handshake, airodump with now show SKA in the AUTH column for the access point</p> <h3 id="deauthentication-attack">Deauthentication Attack</h3> <p>Since it is both faster and easy to deauthenticate a client, we will use that route in this scenario.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -0 1 -a 34:08:04:09:3D:38 -c 00:18:4D:1D:A8:1F mon0</strong></p> </blockquote> <p>After, the client reconnects to the network and airodump will display that is has captured the keystream.</p> <h3 id="shared-key-fake-authentication-attack">Shared Key Fake Authentication Attack</h3> <p>Now that we have the PRGA XOR file for the network, we can now conduct the shared key fake authentication attack, which is largely the same as the normal fake authentication attack.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -1 0 -e hitme -y wep1-34-08-04-09-3D-38.xor -a 34:08:04:09:3D:38 -h 00:1F:33:F3:51:13 mon0</strong></p> </blockquote> <p>The output from the attack should show that is was successful, which we can verify by checking that airodump shows our mac address as being associated with the access point.</p> <h3 id="arp-request-replay-attack">ARP Request Replay Attack</h3> <p>Now that we have gotten past the hurdle of shared key authentication on the access point, we can attack the access point as we did in the <a href="https://lesperance.io/hacking-wep-connected-clients">Hacking WEP With Connected Clients</a> scenario. In this case, we will use the ARP request replay attack due to its extreme reliability.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -3 -b 34:08:04:09:3D:38 -h 00:1F:33:F3:51:13 mon0</strong></p> </blockquote> <p>Now, aireplay is waiting for an ARP packet to appear on the network.</p> <h3 id="deauthentication-attack-1">Deauthentication Attack</h3> <p>We can expedite this process by deauthenticating a connected wireless client. Upon reconnection, it is highly likely the client will send an ARP packet.</p> <blockquote> <p>root@attacker:~# <strong>aireplay-ng -0 1 -a 34:08:04:09:3D:38 -c 00:18:4D:1D:A8:1F mon0</strong></p> </blockquote> <p>Watching our ARP request replay attack, as soon as the client reconnects to the network, it catches an ARP packet and injects it into the network.</p> <p>Checking back to airodump, we can see that IVs are being captured at the rate of a couple hundred per second</p> <h3 id="crack-the-wep-key">Crack the WEP Key</h3> <p>Now that we have captured around 30,000 IVs, we just need to run aircrack-ng against our running capture.</p> <blockquote> <p>root@attacker:~# <strong>aircrack-ng wep1.cap</strong></p> </blockquote> <p>Now we should be presented with the WEP key. If however, aircrack was unable to successfully crack the key, with leaving both the airodump capture running along with aircrack, aircrack will reattempt to crack the key every 5000 new IVs captured.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/blog/bypass-wep-shared-key-auth/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Jesse P Lesperance </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="http://localhost:4000/assets/img/authors/jesse.webp" alt="Jesse P Lesperance" /> </div> <div class="col-md-6"> <p class="author_bio"></p> <p>Email : </p> <p>Website : https://lesperance.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/jplesperance" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/jesseplesperance" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/jlesperance" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> <a class="social-link" href="https://telegram.com/jplesperance" target="_blank"><i class="fab fa-telegram fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "http://localhost:4000/blog/bypass-wep-shared-key-auth/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/bypassing-wep-shared-key-authentication"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Jesse P Lesperance</div> <div class="card-body"> <p class="author_bio"></p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#attacking wifi series"></div> <li class="tag-head"> <a href="/blog/categories/attacking-wifi-series">attacking wifi series</a> </li> <a name="attacking wifi series"></a> <div id="#wifi security"></div> <li class="tag-head"> <a href="/blog/categories/wifi-security">wifi security</a> </li> <a name="wifi security"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000https://github.com/jplesperance">Github</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> </div><footer> Hosted with <a href="https://pages.github.com">Github Pages</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
